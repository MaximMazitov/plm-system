import { PoolClient } from 'pg';

// Группы товаров из Excel файла "группы_исправленные.xlsx"
const productGroups = [
  { code: 'a60', label: 'Футболка детская для девочек' },
  { code: '173', label: 'Носки детские для девочек' },
  { code: '174', label: 'Носки детские для мальчиков' },
  { code: '393', label: 'Детские легинсы' },
  { code: '883', label: 'Футболка длинный рукав детская для девочек' },
  { code: '234', label: 'Колготки детские для девочек' },
  { code: '171', label: 'Трусы детские для девочек' },
  { code: '231', label: 'Пижама детская для девочек' },
  { code: '302', label: 'Юбка детская для девочек' },
  { code: 'a29', label: 'Спортивная одежда для девочек' },
  { code: '191', label: 'Спортивный костюм детский для девочек' },
  { code: '537', label: 'Платье вечернее детское' },
  { code: '238', label: 'Платье детское для девочек' },
  { code: '318', label: 'Набор лиф и трусики детский для девочек' },
  { code: '300', label: 'Футболка детская для девочек' },
  { code: '319', label: 'Гольфы детские для девочек' },
  { code: '181', label: 'Джинсы детские для девочек' },
  { code: 'a54', label: 'Школьные брюки для девочек' },
  { code: '355', label: 'Блузка школьная для девочек' },
  { code: '527', label: 'Брюки детские для девочек' },
  { code: '541', label: 'Майка детская для девочек' },
  { code: '290', label: 'Штаны детские для девочек' },
  { code: '307', label: 'Блузка детская для девочек' },
  { code: '361', label: 'Блузка с коротким рукавом школьная для девочек' },
  { code: '985', label: 'Лифчик подростковый' },
  { code: '367', label: 'Юбка школьная для девочек' },
  { code: '365', label: 'Сарафаны и платья школьные для девочек' },
  { code: '882', label: 'Костюмы, жакеты и жилеты для девочек' },
  { code: 'a68', label: 'Галстуки-банты для девочек' },
  { code: '317', label: 'Набор майка и трусики детский для девочек' },
  { code: '306', label: 'Блузка короткий рукав детская для девочек' },
  { code: '548', label: 'Халат детский для девочек' },
  { code: '310', label: 'Футболка детская для мальчиков' },
  { code: '881', label: 'Футболка длинный рукав детская для мальчиков' },
  { code: '232', label: 'Пижама детская для мальчиков' },
  { code: '172', label: 'Трусы детские для мальчиков' },
  { code: 'a30', label: 'Спортивная одежда для мальчиков' },
  { code: '239', label: 'Спортивный костюм детский для мальчиков' },
  { code: '406', label: 'Рубашка с длинным рукавом школьная для мальчиков' },
  { code: '291', label: 'Штаны детские для мальчиков' },
  { code: '561', label: 'Майка детская для мальчиков' },
  { code: '182', label: 'Джинсы детские для мальчиков' },
  { code: '308', label: 'Рубашка длинный рукав детская для мальчиков' },
  { code: '235', label: 'Колготки детские для мальчиков' },
  { code: '553', label: 'Брюки детские для мальчиков' },
  { code: '565', label: 'Галстук детский для мальчиков' },
  { code: '399', label: 'Рубашка с коротким рукавом школьная для мальчиков' },
  { code: '369', label: 'Брюки школьные для мальчиков' },
  { code: '875', label: 'Костюмы, пиджаки и жилеты для мальчиков' },
  { code: '904', label: 'Подтяжки детские' },
  { code: '566', label: 'Халат детский для мальчиков' },
  { code: '025', label: 'Набор трусы и майка детский для мальчиков' },
  { code: '242', label: 'Джинсы для юношей' },
  { code: '945', label: 'Комплект одежды для маленького мальчика' },
  { code: '940', label: 'Футболка для маленького мальчика' },
  { code: '944', label: 'Комплект одежды для маленькой девочки' },
  { code: '569', label: 'Комбинезон для маленькой девочки' },
  { code: '939', label: 'Футболка для маленькой девочки' },
  { code: '938', label: 'Комбинезон для маленького мальчика' },
  { code: '567', label: 'Боди с длинным рукавом для девочек' },
  { code: '936', label: 'Боди с длинным рукавом для мальчиков' },
  { code: '937', label: 'Боди с коротким рукавом для мальчиков' },
  { code: '568', label: 'Боди с коротким рукавом для девочек' },
  { code: '574', label: 'Распашонка' },
  { code: '911', label: 'Джемпер для маленькой девочки' },
  { code: '573', label: 'Штанишки для маленькой девочки' },
  { code: '912', label: 'Джемпер для маленького мальчика' },
  { code: '900', label: 'Штанишки для маленького мальчика' },
  { code: '890', label: 'Платье для маленькой девочки' },
  { code: '450', label: 'Футболка длинный рукав для маленькой девочки' },
  { code: '941', label: 'Ползунки для мальчика' },
  { code: '572', label: 'Ползунки для девочки' },
  { code: '408', label: 'Футболка длинный рукав для маленького мальчика' },
  { code: '942', label: 'Джинсы для маленького мальчика' },
  { code: '943', label: 'Джинсы для маленькой девочки' },
  { code: '691', label: 'Юбка для маленькой девочки' },
  { code: '576', label: 'Шапочка для новорожденных' },
  { code: '478', label: 'Пеленки текстильные' },
  { code: '584', label: 'Конверт для пеленания' },
  { code: '950', label: 'Майка для маленького мальчика' },
  { code: '964', label: 'Набор трусы и майка для маленькой девочки' },
  { code: '577', label: 'Пинетки' },
  { code: '578', label: 'Царапки' },
  { code: '575', label: 'Чепчик для новорожденных' },
  { code: '891', label: 'Подарочный набор для новорожденных' },
  { code: '899', label: 'Майка для маленькой девочки' },
  { code: '902', label: 'Крестильный набор' },
  { code: '858', label: 'Рубашка для маленького мальчика' },
  { code: '224', label: 'Варежки детские для мальчиков' },
  { code: '708', label: 'Термобелье для мальчиков' },
  { code: '220', label: 'Шапка зимняя детская для мальчиков' },
  { code: '876', label: 'Куртка зимняя детская для мальчиков' },
  { code: 'a74', label: 'Футболка детская новогодняя' },
  { code: 'a73', label: 'Пижама детская новогодняя' },
  { code: '459', label: 'Комплект для мальчиков: куртка зимняя и полукомбинезон' },
  { code: '223', label: 'Варежки детские для девочек' },
  { code: '219', label: 'Шапка зимняя детская для девочек' },
  { code: '709', label: 'Термобелье для девочек' },
  { code: '885', label: 'Куртка зимняя детская для девочек' },
  { code: '458', label: 'Комплект для девочек: куртка зимняя и полукомбинезон' },
  { code: '720', label: 'Карнавальные костюмы для мальчиков' },
  { code: '705', label: 'Карнавальные костюмы для девочек' },
  { code: 'a75', label: 'Новогодняя одежда для новорожденных' },
  { code: '697', label: 'Комплект зимней одежды для маленькой девочки' },
  { code: '895', label: 'Куртка зимняя для маленьких мальчиков' },
  { code: '698', label: 'Комплект зимней одежды для маленького мальчика' },
  { code: '894', label: 'Куртка зимняя для маленьких девочек' },
  { code: '237', label: 'Толстовка детская для девочек' },
  { code: '299', label: 'Платье длинный рукав детское для девочек' },
  { code: '448', label: 'Брюки спортивные утепленные для девочек' },
  { code: '190', label: 'Джемпер детский для девочек' },
  { code: '535', label: 'Водолазка детская для девочек' },
  { code: 'a62', label: 'Треггинсы детские для девочек' },
  { code: '200', label: 'Куртка детская для девочек' },
  { code: '546', label: 'Жилетка детская для девочек' },
  { code: 'a83', label: 'Толстовка-худи утепленная для девочек' },
  { code: 'a90', label: 'Свитшот утепленный для девочки' },
  { code: 'a85', label: 'Толстовка-бомбер утепленная для девочек' },
  { code: 'a87', label: 'Толстовка на молнии утепленная для девочек' },
  { code: '855', label: 'Набор шапка и перчатки детские для девочек' },
  { code: '236', label: 'Толстовка детская для мальчиков' },
  { code: '435', label: 'Брюки спортивные утепленные для мальчиков' },
  { code: '558', label: 'Водолазка детская для мальчиков' },
  { code: '189', label: 'Джемпер детский для мальчиков' },
  { code: '195', label: 'Куртка детская для мальчиков' },
  { code: 'a77', label: 'Толстовка-худи утепленная для мальчиков' },
  { code: 'a79', label: 'Толстовка-бомбер утепленная для мальчиков' },
  { code: 'a92', label: 'Свитшот утепленный для мальчика' },
  { code: '856', label: 'Набор шапка и перчатки детские для мальчиков' },
  { code: '424', label: 'Комбинезон для новорожденных утепленный' },
  { code: '436', label: 'Брюки спортивные утепленные для маленьких мальчиков' },
  { code: '455', label: 'Брюки спортивные утепленные для маленьких девочек' },
  { code: 'a56', label: 'Зимний детский комбинезон для девочек' },
  { code: '225', label: 'Перчатки детские для девочек' },
  { code: '240', label: 'Свитер детский для девочек' },
  { code: '887', label: 'Полукомбинезон зимний детский для девочек' },
  { code: '533', label: 'Шарф детский для девочек' },
  { code: 'a53', label: 'Вязаные рейтузы для девочек' },
  { code: '540', label: 'Джинсы детские для девочек утепленные' },
  { code: '888', label: 'Кардиган детский для девочек' },
  { code: '523', label: 'Пальто зимнее детское для девочек' },
  { code: '297', label: 'Кофта детская для девочек' },
  { code: '343', label: 'Штаны утепленные детские для девочек' },
  { code: '438', label: 'Платье вязаное для девочек' },
  { code: '217', label: 'Ушки меховые детские' },
  { code: '045', label: 'Набор шапка и шарф детский для девочек c размером' },
  { code: 'a69', label: 'Юбка вязаная для девочек' },
  { code: '221', label: 'Набор шапка и шарф детский для девочек' },
  { code: 'a55', label: 'Зимний детский комбинезон для мальчиков' },
  { code: '226', label: 'Перчатки детские для мальчиков' },
  { code: '557', label: 'Кофта детская для мальчиков' },
  { code: '556', label: 'Шарф детский для мальчиков' },
  { code: '241', label: 'Свитер детский для мальчиков' },
  { code: '878', label: 'Полукомбинезон зимний детский для мальчиков' },
  { code: '860', label: 'Джинсы детские для мальчиков утепленные' },
  { code: '879', label: 'Штаны утепленные детские для мальчиков' },
  { code: '953', label: 'Кардиган детский для мальчиков' },
  { code: '563', label: 'Жилетка детская для мальчиков' },
  { code: '222', label: 'Набор шапка и шарф детский для мальчиков' },
  { code: '046', label: 'Набор шапка и шарф детский для мальчиков с размером' },
  { code: '896', label: 'Комбинезон для новорожденных зимний для мальчиков' },
  { code: '570', label: 'Комбинезон для новорожденных зимний для девочек' },
  { code: '889', label: 'Кофточка для маленького мальчика' },
  { code: '861', label: 'Джинсы для маленького мальчика утепленные' },
  { code: '571', label: 'Кофточка для маленькой девочки' },
  { code: '862', label: 'Джинсы для маленькой девочки утепленные' },
  { code: 'y49', label: 'Комплект летней одежды для девочки' },
  { code: 'a50', label: 'Капри и велосипедки для девочек' },
  { code: '966', label: 'Сарафан джинсовый детский для девочек' },
  { code: 'a51', label: 'Детские легинсы три четверти' },
  { code: 'b36', label: 'Косынка детская для девочек' },
  { code: '530', label: 'Панама детская для девочек' },
  { code: 'a52', label: 'Брюки летние для девочек' },
  { code: '201', label: 'Бейсболка детская для девочек' },
  { code: '962', label: 'Комплект летней одежды для маленького мальчика' },
  { code: '961', label: 'Комплект летней одежды для маленькой девочки' },
  { code: 'a57', label: 'Летнее платье для маленькой девочки' },
  { code: '926', label: 'Полукомбинезон для маленькой девочки' },
  { code: '958', label: 'Полукомбинезон для маленького мальчика' },
  { code: 'y50', label: 'Комплект летней одежды для мальчиков' },
  { code: '202', label: 'Бейсболка детская для мальчиков' },
  { code: '554', label: 'Панама детская для мальчиков' },
  { code: '192', label: 'Рубашка детская для мальчиков' },
  { code: '044', label: 'Шапка детская демисезонная для мальчиков' },
  { code: 'y53', label: 'Брюки демисезонные для мальчика' },
  { code: '877', label: 'Жилет утепленный детский для мальчиков' },
  { code: '952', label: 'Ветровка детская для мальчиков' },
  { code: 'y57', label: 'Куртка для мальчиков облегченная' },
  { code: 'a63', label: 'Дождевик детский для мальчиков' },
  { code: 'y52', label: 'Комбинезон демисезонный для мальчика' },
  { code: '043', label: 'Шапка детская демисезонная для девочек' },
  { code: 'y54', label: 'Брюки демисезонные для девочек' },
  { code: '886', label: 'Жилет утепленный детский для девочек' },
  { code: '954', label: 'Ветровка детская для девочек' },
  { code: 'y56', label: 'Куртка для девочек облегченная' },
  { code: 'a64', label: 'Дождевик детский для девочек' },
  { code: 'y51', label: 'Комбинезон демисезонный для девочек' },
  { code: '956', label: 'Плащ детский для девочек' },
  { code: '948', label: 'Куртка для маленьких девочек' },
  { code: '949', label: 'Куртка для маленьких мальчиков' },
  { code: 'a71', label: 'Комбинезон демисезонный для маленькой девочки' },
  { code: 'a72', label: 'Комбинезон демисезонный для маленького мальчика' },
  { code: '727', label: 'Жилет утепленный для маленькой девочки' },
  { code: 'y59', label: 'Ветровка для маленьких мальчиков' },
  { code: '726', label: 'Жилет утепленный для маленького мальчика' },
  { code: 'y58', label: 'Ветровка для маленьких девочек' },
  { code: '536', label: 'Платье летнее детское' },
  { code: '194', label: 'Шорты детские для девочек' },
  { code: '955', label: 'Топ детский для девочек' },
  { code: '313', label: 'Купальник детский' },
  { code: '292', label: 'Сарафан детский для девочек' },
  { code: '305', label: 'Комбинезон летний детский для девочек' },
  { code: '303', label: 'Юбка летняя детская' },
  { code: 'a65', label: 'Туника пляжная детская' },
  { code: '392', label: 'Детская летняя шляпа для девочек' },
  { code: '532', label: 'Косынка детская для девочек' },
  { code: '193', label: 'Шорты детские для мальчиков' },
  { code: '312', label: 'Плавки детские' },
  { code: '925', label: 'Платье-боди' },
  { code: '946', label: 'Ромпер для мальчика' },
  { code: '947', label: 'Ромпер для девочки' },
  { code: '965', label: 'Шорты для маленького мальчика' },
  { code: '859', label: 'Шорты для маленькой девочки' },
  { code: '963', label: 'Сарафан для маленькой девочки' },
  { code: '968', label: 'Куртка джинсовая для мальчика' },
  { code: 'a91', label: 'Свитшот для мальчика' },
  { code: 'a82', label: 'Толстовка на молнии для мальчиков' },
  { code: 'a80', label: 'Толстовка-бомбер для мальчиков' },
  { code: 'a78', label: 'Толстовка-худи для мальчиков' },
  { code: '967', label: 'Куртка джинсовая для девочки' },
  { code: 'a89', label: 'Свитшот для девочки' },
  { code: 'a88', label: 'Толстовка на молнии для девочек' },
  { code: 'a84', label: 'Толстовка-худи для девочек' },
  { code: 'a86', label: 'Толстовка-бомбер для девочек' },
];

export async function seedProductGroups(client: PoolClient) {
  console.log('Seeding product groups from Excel file...');

  let insertedCount = 0;
  let skippedCount = 0;

  for (let i = 0; i < productGroups.length; i++) {
    const item = productGroups[i];

    try {
      // Check if already exists
      const existing = await client.query(
        `SELECT id FROM reference_data WHERE category = 'product_group' AND code = $1`,
        [item.code]
      );

      if (existing.rows.length > 0) {
        skippedCount++;
        continue;
      }

      await client.query(
        `INSERT INTO reference_data (category, code, value, label, sort_order, is_active)
         VALUES ('product_group', $1, $2, $3, $4, true)`,
        [item.code, item.code, item.label, i + 1]
      );
      insertedCount++;
    } catch (error: any) {
      if (error.code === '23505') { // unique constraint violation
        skippedCount++;
      } else {
        console.error(`Error inserting product group ${item.code}:`, error.message);
      }
    }
  }

  console.log(`Product groups seeding complete: ${insertedCount} inserted, ${skippedCount} skipped (already exist)`);
}
